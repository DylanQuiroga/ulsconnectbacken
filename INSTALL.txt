ULSConnect Backend - Instrucciones de instalación

Archivo: INSTALL.txt
Ruta: ./INSTALL.txt

Propósito:
Este archivo contiene los pasos mínimos que deben seguir otros desarrolladores para instalar, configurar y ejecutar el proyecto en desarrollo (Windows - PowerShell). Adáptalo según el entorno de producción.

REQUISITOS
- Node.js >= 16 (recomendado 18+)
- npm (v8+)
- MongoDB accesible (local o Atlas)
- (Opcional) PM2 para producción

PASOS RÁPIDOS (Desarrollo)
1) Clona el repositorio
   git clone https://github.com/DylanQuiroga/ulsconnectbacken.git
   cd ulsconnectbacken

2) Instala dependencias
   # PowerShell
   npm install

3) Configura variables de entorno
   - Copia el ejemplo y edítalo:
     copy .env.example .env
     # (o en PowerShell)
     cp .env.example .env

   - Configura MongoDB en `.env` (REQUERIDO):
     OPCIÓN A - MongoDB Local (necesita instalación):
       1. Descarga MongoDB Community: https://www.mongodb.com/try/download/community
       2. Instala y asegúrate de que el servicio esté corriendo
       3. En `.env`, usa:
          MONGO_URI=mongodb://localhost:27017/ulsconnect
       
     OPCIÓN B - MongoDB Atlas (nube, recomendado para desarrollo):
       1. Crea cuenta gratis en https://www.mongodb.com/cloud/atlas
       2. Crea un cluster
       3. Obtén la connection string (incluye usuario/contraseña)
       4. En `.env`, reemplaza:
          MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/ulsconnect

   - Configura Session Secret en `.env` (REQUERIDO):
     SESSION_SECRET=tu-clave-aleatoria-segura-minimo-32-caracteres
     # Ej: SESSION_SECRET=a7f9b2e4c1d5f8a3e7c9b2d4f6a8e1c3

   - Configura Email/SMTP en `.env` (OPCIONAL):
     Para desarrollo, puedes dejar vacío. En producción:
     - Gmail: Genera "App Password" (2FA debe estar activo)
     - Ethereal (test): https://ethereal.email/create
     - Mailtrap (test): https://mailtrap.io/
     
   - Rate Limiting en `.env` (OPCIONAL):
     RATE_LIMIT_WINDOW_MS=900000  (15 min en ms)
     RATE_LIMIT_MAX_REQUESTS=5    (máx 5 requests)

4) Ejecuta la app en desarrollo
   npm run dev
   # Esto inicia la app con nodemon (recarga automática en cambios)
   # O sin nodemon:
   npm start

5) Ejecuta pruebas de integración (rápidas)
   node test-integration.js
   # Puedes ajustar TEST_API_URL si tu servidor no está en localhost:3000
   # TEST_API_URL=http://localhost:3000 node test-integration.js

COMANDOS ÚTILES (PowerShell)
- Instalar pm2 globalmente (opcional):
  npm install -g pm2
- Iniciar con pm2:
  pm2 start app.js --name ulsconnect --env production
- Guardar configuración pm2:
  pm2 save

DESPLIEGUE (resumen rápido)
- Usar un reverse proxy (nginx) con SSL
- Asegurar `SESSION_SECRET` y credenciales en variables de entorno
- Ejecutar `npm install --production` en el servidor
- Usar PM2 o Docker para gestión de procesos

NOTAS IMPORTANTES
- MongoDB en desarrollo: 
  * Opción 1 (Local): Instala MongoDB Community y corre localmente
  * Opción 2 (Cloud): Usa MongoDB Atlas (recomendado, gratis tier disponible)
  * Sin MongoDB, verás warnings pero la app seguirá funcionando (fallará al guardar datos)
- Email en desarrollo: el aviso "Email service not configured..." es NORMAL si no configuras SMTP. 
  No afecta el funcionamiento; solo significa que no se enviarán notificaciones por correo.
- Cookies seguras: en producción `NODE_ENV=production` + HTTPS garantiza que `cookie.secure` funcione.
- CSRF: las vistas EJS ya incluyen el campo `_csrf`; si usas API JSON, valida que el cliente envíe el token.
- Dominios permitidos para registro: `@usena.cl` y `@alumnouls.cl` (validador en rutas de registro).
- nodemon: `npm run dev` reinicia la app automáticamente al detectar cambios en archivos `.js` o `.json`.

Contacto / Soporte
- Repo: https://github.com/DylanQuiroga/ulsconnectbacken
- Si falta algo en estas instrucciones, por favor abre un issue o PR con la mejora.

Última actualización: 2025-11-17
